name: Build packager Docker image
# This workflow is triggered on pushes to the repository.
on: 
  push:

env:
  DOCKER_BRANCH_RELEASE_PATTERN: 'release/*[0-9].*[0-9].*[0-9]' 
  DOCKER_BRANCH_DEVELOP_PATTERN: 'develop' 
  DOCKER_BRANCH_FEATURE_PATTERN: 'feature/.*' 
  DOCKER_TAG_PATTERNS: '.*'
  REGISTRY_URL: nexus.texel.live
  RELEASE_PORT: 5000  
  DEVELOP_PORT: 5002
  TRIVY_USERNAME: ${{ secrets.DOCKER_USER }}
  TRIVY_PASSWORD: ${{ secrets.DOCKER_PASSWORD }}

jobs:
 debug: true
   
   Match-ref-patterns:
    runs-on: ubuntu-latest
    outputs:
      pattern-matched: ${{ steps.matching.outputs.pattern-matched }}
      registry: ${{ steps.matching.outputs.registry }}
      ref: ${{ steps.matching.outputs.ref }}
      debug: true
    steps:
      - uses: actions/checkout@v2
      - id: foo
        uses: drorvt/composite-match-ref-patterns@main
        
